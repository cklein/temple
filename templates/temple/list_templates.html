<html>
<head>
    <script src="http://localhost:5984/_utils/script/jquery.js?1.3.1" type="text/javascript"></script>
    <script type="text/javascript">
        <!--
            var modified = false;
            var text = "";
            
            $("document").ready(function() {
                $("#template_select").change(function() {
                    
                    var params = {"id": $("#template_select").val()};
                    $.post("../get/", params, function(data) {
                        text = data.source;
                        $("#source").val(data);
                    });
                });
                
                $("#source").keyup(function() {
                    modified = true;
                });
                
                $("#edit_form").submit(function() {
                    if(modified) {
                        //if($("#source").val() != text) {
                        var params = {"id": $("#template_select").val(),
                                      "source": $("#source").val()};
                        $.post("../set/", params, function(data) {
                            if(data.status != 'ok') {
                                $("#result").text(data.msg);
                            } else {
                                $("#result").text('');
                            }
                        }, "json");
                    }
                    return false;
                });
            });
            
        // -->
    </script>
</head>
<body>
<form id="edit_form" action="." method="POST">
<div>
    <select name="template" id="template_select">
        <option value="1">test</option>
{% for id, name in templates %}
        <option value="{{ id }}">{{ name }}</option>
{% endfor %}
    </select>
</div>
<div><textarea id="source" name="source"></textarea></div>
<input type="submit" value="Speichern" />
</form>

result: <span id="result"></span>

</body>
</html>